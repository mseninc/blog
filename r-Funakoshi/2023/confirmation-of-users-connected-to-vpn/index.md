---
title: "FortiGate でリアルタイムな VPN 接続ユーザーを確認する方法"
date: 2023-07-12
author: r-Funakoshi
tags: [FortiGate]
description: FortiGate で VPN 接続中のユーザーがいるかどうか GUI と CLI 両方から確認する方法を紹介します。

---

みなさまこんにちは、リーフです。

先日 VPN 機器として稼働している FortiGate に対して設定変更を行う機会がありました。
機器の設置前など、稼働していない環境であれば任意のタイミングで設定を変更できますが、
すでに稼働している環境の場合ユーザーへの影響が少ない時間帯に実施する必要があります。

もちろん夜間や休日に実施することも1つの手ですが、VPN 接続中ユーザーの有無が分かれば、ユーザーがいないタイミングで設定を変更できます。

今回は FortiGate で*リアルタイムに VPN 接続中のユーザー有無*を確認する方法を紹介します。

弊社では主に **SSL-VPN** を使用していますが、 **IPsec** を使用した際の確認方法も紹介します。

※あくまでも VPN 接続中のユーザーを確認する方法ですのでローカルネットワーク側で接続しているユーザーに関しては別途確認する必要があります。

GUI・CLI の両方で確認が可能です。
お好きな方法で確認してみてください。

### 想定環境
- Forti OS(メジャーバージョン):v7

### GUI で確認する方法
1. FortiGate の管理画面へログインします。

1. 左ペイン > ネットワークの順番にクリックします。

1. 画面をスクロールし、SSL-VPN または IPsec を選択します。
![ネットワーク](images/screen-GUI.png "ネットワーク")
4. ダブルクリックで詳細を開きます。
**ユーザー名**に表示される名前が現在接続中のユーザーです。
![接続ユーザーGUI](images/connection-user-GUI.png "接続ユーザー GUI 画面")
※画像は SSL-VPN のものです。

### CLI で確認する方法
1. FortiGate のコンソールへログインします。

1. 以下のコマンドを入力します。

- SSL-VPN の場合

```get vpn ssl monitor```

- IPsec の場合

```diagnose vpn ike gateway list```

3. `User` に表示される名前が現在接続中のユーザーです。

![CLI 画面](images/connection-user-CLI.png "接続ユーザー CLI 画面")
※画像は SSL-VPN のものです。


### 最後に
今回は FortiGate で VPN 接続中のユーザーを確認しました。

稼働中の環境で設定を変更する場合は、ぜひ本手順を参考にしてみてください。

それではまた、リーフでした。🍃
