---
title: WordPress パーミッションが適切でなくアップデートが失敗する時の解決方法
date: 2016-08-26
author: kiyoshin
tags: [WordPress, その他]
---

WordPress の新しいバージョン 4.6 が公開されていたので、管理画面から更新しようとするとこんなエラーメッセージが出ました。

**「いくつかのファイルをコピーできないため、最新版のインストールができません。これはたいていの場合、ファイルのパーミッションが適切でないことが原因です。」**

このエラーメッセージの後に、ファイルパスがズラズラ～と並んでいました。

その数、約400ファイル！

このブログはレンタルサーバーでの運用では無いため、サーバー内対象ファイルのパーミッションを自分で変更しなければなりません。

## パーミッションとは
ここではあまり難しい事は書きませんが、簡単に説明しておきます。

ファイルやフォルダに対するアクセス権（操作する権利）の事です。

パーミッションは rwxr-xr-x などの9文字の文字列で表します。
左から3つの文字がオーナー（管理者）
中央の3つの文字がグループ（管理者が許可した人）
右から3つの文字がその他（外部）
それぞれのアクセス権を表しています。

文字列の意味は
r は読込可能
w は書込可能
x は実行可能
- は全て不可能

また、パーミッションを数値で表す場合は、r＝4、w＝2、x＝1、を割り当て、合計します。
例えば上記の rwxr-xr-x は、4+2+1, 4+1, 4+1 で、755 となります。

詳しく知りたい方は「パーミッション」で検索！

## パーミッション変更時の注意
**パーミッション変更前に必ずバックアップ（元の状態に復元できる状態）や、対象パーミッションの確認とメモ（スクリーンショット等）をしてください。**

私もやらかしましたが、間違ったパーミッションにしてしまうと、サイトが表示されなくなります ＼(^o^)／

## 対象ファイルのパーミッションの変更方法
さて、実際にパーミッションを変更していきます。

今回はWordPress（外部）からのアップデート（書込）を許可したいので、**エラーが起こっている対象ファイルパーミッションの右から3つの文字を、読込可能 + 書込可能の rw- に変更**します。

数字で表すと 一番右が 6 になれば良いという事です。

ここからはサーバー内を操作する為のソフトによって違ってきます。

### コマンドラインツール（Tera Term等）の場合
まず、対象ファイルを ` ls -l ` 等を使い、現在のパーミッションを確認します。

エラーが起こっているファイルは r-- になっていると思うので、rw- に変更していきます。

コマンドラインの操作で、以下の様なコマンドを入力し、対象ファイルのパーミッションを変更してください。

` chmod 666 対象ファイル名 `

666 のところはご自分の環境に適したパーミッションに変更してください。

今回の様に対象ファイルが多い場合は、コマンドラインツールの方が一気に変更する事が可能なので楽です。

テキストエディター（正規表現）や Excel（& や CONCATENATE関数） を使い、大量の対象ファイルパスの前に `chmod 666` 等の文字列を一括で挿入しコピー。コマンドラインツールにペーストして実行させます。

### FFFTP や WinSCP の場合
対象のファイルをマウスで右クリックして、ポップアップメニューからプロパティや属性変更で変更できます。

![WordPressPermission](images/wordpress-permissionerror-1.png)

見たまんま操作できるので、簡単ですね～。

複数のファイルを選択してから右クリックすると一括でパーミッションの変更も可能です。

## パーミッションの変更ができない場合
対象ファイルより上のフォルダのパーミッションが関係している場合があります。

フォルダのパーミッションを確認して、自分にアクセス権があるか判断してください。

自分が管理者でない場合は、そもそもアクセス権が無いのかもしれないので、管理者に確認してください。

## あとがき
パーミッションの変更は結構重要な事なので、自分の他に管理者がいる場合は、必ず相談してからにしてください。

パーミッションの変更はドキドキしますが、頑張ってやってみましょう！